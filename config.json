{
	"name": "Capture Save Time",

	"namespace": "MCRI\\CaptureSaveTime",

	"authors": [
		{
			"name": "Jack Ren",
			"email": "jack.ren@mcri.edu.au",
			"institution": "Murdoch Children's Research Institute"
		},
		{
			"name": "Luke Stevens",
			"email": "luke.stevens@mcri.edu.au",
			"institution": "Murdoch Children's Research Institute"
		}
	],

	"description": "This External Module captures the date/time when a Data Entry Form and/or Survey is saved/submitted into a text field. The format of the date/time will match with the datetime validation of the text field. <br><br>The user can specify the conditions that triggers the module to capture the time.<br><br>Clicking on \"Click here for advanced settings for surveys\" unlocks additional conditions. The <b>Select time capture setting in survey:</b> setting allows user to specify whether to capture the time <b>hen the survey is saved on any page</b> or <b>just the page that contains the field</b>. The user can then select the <b>Survey buttons (Previous page, Next page/Submit, Save & Return Later)</b> that will trigger the time capturing.Finally, the user can specify <b>whether to capture the time when the survey is first saved/submitted</b>(i.e. if the field is empty) or <b>for every saves/submits</b>. ",

	"permissions": [
			"redcap_survey_complete",
			"redcap_save_record"
		],
	"system-settings": [
		{
			"name": "System will send an email from this address if the module fails to capture the time",
			"key": "captime_system_email",
			"type": "text",
			"required": true
		},
		{
			"name": "System will CC the email to this address if the module fails to capture the time",
			"key": "captime_cc_email",
			"type": "text",
			"repeatable": true
		}],
	"project-settings": [
		{
			"name": "Send an email to this address in case an error occurs with capturing the time",
			"key": "captime_email"
		},
		{
			"name": "Settings for each instrument",
			"key": "instrument_settings",
			"type": "sub_settings",
			"repeatable": true,
			"sub_settings": [
				{
					"name": "Select which instrument to add the capture functionality",
					"key": "captime_instrument",
					"required": true,
					"type": "form-list"
				},
				{
					"name": "Select which field to capture the time. Remember to set the date/time validation for this field",
					"key": "captime_field",
					"required": true,
					"type": "field-list"
				},
				{
					"name": "Capture time for Data Entry Form Save",
					"key": "captime_form_save",
					"type": "checkbox"
				},
				{
					"name": "Capture time for Data Entry Form Complete",
					"key": "captime_form_complete",
					"type": "checkbox"
				},
				{
					"name": "Capture time for Survey Completion (i.e. after submitting the survey successfully)",
					"key": "captime_survey_complete",
					"type": "checkbox"
				},
				{
					"name": "Click here for advanced settings for surveys:",
					"key": "captime_adv_setting",
					"type": "checkbox"
				},
				{
					"name": "Select time capture setting in survey",
					"key": "captime_survey_setting",
					"required": true,
					"type": "radio",
					"choices": [
						{
							"name": "Capture time for any survey pages",
							"value": "captime_survey_setting_all"
						},
						{
							"name": "Capture time for just the page containing the field",
							"value": "captime_survey_setting_spec"
						}
					],
					"branchingLogic": {
						"conditions": [
							{
								"field": "captime_adv_setting",
								"value": "1"
							}
						]
					}
				},
				{
					"name": "Capture time for Survey Save & Return Later",
					"key": "captime_survey_save",
					"type": "checkbox",
					"branchingLogic": {
						"conditions": [
							{
								"field": "captime_adv_setting",
								"value": "1"
							}
						]
					}
				},
				{
					"name": "Capture time for Survey Next Page/Submit",
					"key": "captime_survey_submit",
					"type": "checkbox",
					"branchingLogic": {
						"conditions": [
							{
								"field": "captime_adv_setting",
								"value": "1"
							}
						]
					}
				},
				{
					"name": "Capture time for Survey Previous Page",
					"key": "captime_survey_prev",
					"type": "checkbox",
					"branchingLogic": {
						"conditions": [
							{
								"field": "captime_adv_setting",
								"value": "1"
							}
						]
					}
				},
				{
					"name": "Select how often to capture the time",
					"key": "captime_freq",
					"required": true,
					"type": "radio",
					"choices": [
						{
							"name": "Only capture the time upon the first save/submit (i.e. If the field is empty)",
							"value": "captime_freq_first"
						},
						{
							"name": "Always capture the time upon saves/submits",
							"value": "captime_freq_all"
						}
					]
				}
			]
		}],
    "compatibility": {
        "redcap-version-min": "8.0.3"
    }
}
